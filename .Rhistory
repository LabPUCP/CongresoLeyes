data$Impuestos = factor(ifelse(grepl("impuesto", data$sumilla),1,0))
#Penal
data$Penal = factor(ifelse(grepl("penal", data$sumilla),1,0))
#Sistema:
data$Sistema = factor(ifelse(grepl("sistema", data$sumilla),1,0))
#Provincia:
data$Provincia = factor(ifelse(grepl("provincia", data$sumilla),1,0))
leyesCongreso = data %>% group_by(congresoR) %>%  summarise(leyes=n())
ggplot(data=leyesCongreso, aes(x=congresoR, y=leyes)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Propuestas de ley por legislatura", y="Numero total", x="Legislatura", caption="Promedio de propuestas de ley por legislatura: 6 917") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(plot.title = element_text(hjust = 0.5)) + geom_hline(yintercept = mean(leyesCongreso$leyes) ,linetype="dashed", color="red")  + geom_text(aes(label=leyes), vjust=1.6, color="white", size=3)
proponentes1 = data %>% filter(congresoR=="C1995_2000") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes[c(1,2)], options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:14)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (1995-2000)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>%
group_by(proponenteR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (1995-2000)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 26.2 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 26.17168 ,linetype="dashed", color="red")
proponentes1 = data %>% filter(congresoR=="C1995_2000" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
dataText = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
dataText = data %>% filter(congresoR=="C1995_2000" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()
m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))
ggarrange(m2,m1, ncol = 2, nrow = 1)
ModeloCongreso1=data[data$congresoR=='C1995_2000',]
library(survival)
ModeloCongreso1$PromulgadaSurv=with(ModeloCongreso1,Surv(TiempoP, as.numeric(Promulgado)))
etiquetas=c("Grupo Oficialista", "Propone Ejecutivo", "Impuestos")
modelo1 <- coxph(PromulgadaSurv ~ GPOficialista + ProponeEjecutivo + Impuestos,data=ModeloCongreso1)
stargazer(modelo1, type = "text",
apply.coef = exp,
apply.se   = exp,covariate.labels=etiquetas,note="Nota: se muestran los coeficientes exp.")
proponentes1 = data %>% filter(congresoR=="C2001_2006") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:15)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2001-2006)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>%
group_by(proponenteR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2001-2006)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 49 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 48.96217 ,linetype="dashed", color="red")
proponentes1 = data %>% filter(congresoR=="C2001_2006" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes[c(1,2)], options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:11)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2001-2006)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1" & proponenteR == "Congreso") %>%
group_by(grupoParlamentarioR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2001-2006)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 53 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 53.42184 ,linetype="dashed", color="red")
dataText = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
dataText = data %>% filter(congresoR=="C2001_2006" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()
m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 800, by = 100))
ggarrange(m2,m1, ncol = 2, nrow = 1)
ModeloCongreso1=data[data$congresoR=='C2001_2006',]
library(survival)
ModeloCongreso1$PromulgadaSurv=with(ModeloCongreso1,Surv(TiempoP, as.numeric(Promulgado)))
etiquetas=c("Grupo Oficialista", "Propone Ejecutivo", "Penal", "Impuestos")
modelo1 <- coxph(PromulgadaSurv ~ GPOficialista + ProponeEjecutivo + Penal + Impuestos,data=ModeloCongreso1)
stargazer(modelo1, type = "text",
apply.coef = exp,
apply.se   = exp,covariate.labels=etiquetas,note="Nota: se muestran los coeficientes exp.")
proponentes1 = data %>% filter(congresoR=="C2006_2011") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes[c(1,2)], options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:16)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2006-2011)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>%
group_by(proponenteR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2006-2011)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 47 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 46.74928 ,linetype="dashed", color="red")
proponentes1 = data %>% filter(congresoR=="C2006_2011" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes[c(1,2)], options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:15)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2006-2011)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1" & proponenteR == "Congreso") %>%
group_by(grupoParlamentarioR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2006-2011)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 60 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 59.86643 ,linetype="dashed", color="red")
dataText = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
dataText = data %>% filter(congresoR=="C2006_2011" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()
m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))
ggarrange(m2,m1, ncol = 2, nrow = 1)
ModeloCongreso1=data[data$congresoR=='C2006_2011',]
library(survival)
ModeloCongreso1$PromulgadaSurv=with(ModeloCongreso1,Surv(TiempoP, as.numeric(Promulgado)))
etiquetas=c("Grupo Oficialista", "Propone Ejecutivo", "Penal")
modelo1 <- coxph(PromulgadaSurv ~ GPOficialista + ProponeEjecutivo + Penal,data=ModeloCongreso1)
stargazer(modelo1, type = "text",
apply.coef = exp,
apply.se   = exp,covariate.labels=etiquetas,note="Nota: se muestran los coeficientes exp.")
proponentes1 = data %>% filter(congresoR=="C2011_2016") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:16)
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:17)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2011-2016)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>%
group_by(proponenteR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2011-2016)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 46 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 45.99001 ,linetype="dashed", color="red")
proponentes1 = data %>% filter(congresoR=="C2011_2016" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:15)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2011-2016)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1" & proponenteR == "Congreso") %>%
group_by(grupoParlamentarioR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2011-2016)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 56 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 55.59501 ,linetype="dashed", color="red")
dataText = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
dataText = data %>% filter(congresoR=="C2011_2016" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()
m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))
ggarrange(m2,m1, ncol = 2, nrow = 1)
ModeloCongreso1=data[data$congresoR=='C2011_2016',]
library(survival)
ModeloCongreso1$PromulgadaSurv=with(ModeloCongreso1,Surv(TiempoP, as.numeric(Promulgado)))
etiquetas=c("Grupo Oficialista", "Propone Ejecutivo", "Penal")
modelo1 <- coxph(PromulgadaSurv ~ GPOficialista + ProponeEjecutivo + Penal,data=ModeloCongreso1)
stargazer(modelo1, type = "text",
apply.coef = exp,
apply.se   = exp,covariate.labels=etiquetas,note="Nota: se muestran los coeficientes exp.")
proponentes1 = data %>% filter(congresoR=="C2016_2021") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:13)
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:14)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2016-2021)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>%
group_by(proponenteR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>%
group_by(proponenteR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2016-2021)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 32 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 31.82399 ,linetype="dashed", color="red")
proponentes1 = data %>% filter(congresoR=="C2016_2021"& proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())
proponentes2 = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())
proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]
datatable(proponentes[c(1,2)], options=list(pageLength=5, scrollX="500px"))
proponentes = proponentes  %>%
mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)
proponentes$orden=c(1:10)
proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)
proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) +
geom_bar(stat = "identity") + coord_flip() +
geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2016-2021)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
theme(panel.background=element_rect(fill = "white", colour = "black"))
#Promedios:
meanTiempo = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1" & proponenteR == "Congreso") %>%
group_by(grupoParlamentarioR) %>%
summarise(Leyes = n(),
Tiempo = mean(as.numeric(TiempoP)),
seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) +
geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2016-2021)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 35 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 34.64286 ,linetype="dashed", color="red")
dataText = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
dataText = data %>% filter(congresoR=="C2016_2021" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()
m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))
ggarrange(m2,m1, ncol = 2, nrow = 1)
ModeloCongreso1=data[data$congresoR=='C2016_2021',]
library(survival)
ModeloCongreso1$PromulgadaSurv=with(ModeloCongreso1,Surv(TiempoP, as.numeric(Promulgado)))
etiquetas=c("Grupo Oficialista", "Propone Ejecutivo", "Penal")
modelo1 <- coxph(PromulgadaSurv ~ GPOficialista + ProponeEjecutivo + Penal,data=ModeloCongreso1)
stargazer(modelo1, type = "text",
apply.coef = exp,
apply.se   = exp,covariate.labels=etiquetas,note="Nota: se muestran los coeficientes exp.")
