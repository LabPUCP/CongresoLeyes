<img src="https://github.com/ERMPeru/elecciones2016/raw/master/headerLogo.png" width="1000">


## Análisis de Promulgación de Leyes en el Congreso Peruano

#### Elaborado por el [Laboratorio de Políticas Públicas de la PUCP](#team)

-----

```{r include=FALSE}
##Paquetes a instalar
library(stringr)
library(survival)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(DT)
library(tm)
library(wordcloud)
library(RColorBrewer)
library(ggpubr)
library(stargazer)
```

```{r include=FALSE}
seMean = function(x) sd(x)/sqrt(length(x))
```

```{r include=FALSE}
#cargar data
data=read.csv("dfall1.csv", stringsAsFactors = F)
```

```{r include=FALSE}
data=data[-1] #Elimino partido politico, ya tenemos grupo partidario 
names(data)
```

```{r include=FALSE}
#periodo Congreso
data$congresoR[data$congreso == names(table(data$congreso))[1]] = "C1995_2000"
data$congresoR[data$congreso == names(table(data$congreso))[2]] = "C2001_2006"
data$congresoR[data$congreso == names(table(data$congreso))[3]] = "C2006_2011"
data$congresoR[data$congreso == names(table(data$congreso))[4]] = "C2011_2016"
data$congresoR[data$congreso == names(table(data$congreso))[5]] = "C2011_2016"
data$congresoR[data$congreso == names(table(data$congreso))[6]] = "C2016_2021"
```

```{r include=FALSE}
#Proponente
data$proponenteR[data$proponente == names(table(data$proponente))[1]] = NA
data$proponenteR[data$proponente == names(table(data$proponente))[2]] = "BCR"
data$proponenteR[data$proponente == names(table(data$proponente))[3]] = "BCR"
data$proponenteR[data$proponente == names(table(data$proponente))[4]] = "Colegios Profesionales"
data$proponenteR[data$proponente == names(table(data$proponente))[5]] = "Colegios Profesionales"
data$proponenteR[data$proponente == names(table(data$proponente))[6]] = "CNM"
data$proponenteR[data$proponente == names(table(data$proponente))[7]] = "Gobiernos Regionales"
data$proponenteR[data$proponente == names(table(data$proponente))[8]] = "Contraloria"
data$proponenteR[data$proponente == names(table(data$proponente))[9]] = "Poder Judicial"
data$proponenteR[data$proponente == names(table(data$proponente))[10]] = "Colegios Profesionales"
data$proponenteR[data$proponente == names(table(data$proponente))[11]] = "Congreso"
data$proponenteR[data$proponente == names(table(data$proponente))[12]] = "CNM"
data$proponenteR[data$proponente == names(table(data$proponente))[13]] = "Contraloria"
data$proponenteR[data$proponente == names(table(data$proponente))[14]] = "Poder Judicial"
data$proponenteR[data$proponente == names(table(data$proponente))[15]] = "Defensoria"
data$proponenteR[data$proponente == names(table(data$proponente))[16]] = "Defensoria"
data$proponenteR[data$proponente == names(table(data$proponente))[17]] = "Fiscalia"
data$proponenteR[data$proponente == names(table(data$proponente))[18]] = "Gobiernos Locales"
data$proponenteR[data$proponente == names(table(data$proponente))[19]] = "Gobiernos Regionales"
data$proponenteR[data$proponente == names(table(data$proponente))[20]] = "Iniciativas Ciudadanas"
data$proponenteR[data$proponente == names(table(data$proponente))[21]] = "JNE"
data$proponenteR[data$proponente == names(table(data$proponente))[22]] = "JNE"
data$proponenteR[data$proponente == names(table(data$proponente))[23]] = "Gobiernos Locales"
data$proponenteR[data$proponente == names(table(data$proponente))[24]] = "Ministerio Publico"
data$proponenteR[data$proponente == names(table(data$proponente))[25]] = "Gobiernos Locales"
data$proponenteR[data$proponente == names(table(data$proponente))[26]] = "ONPE"
data$proponenteR[data$proponente == names(table(data$proponente))[27]] = "ONPE"
data$proponenteR[data$proponente == names(table(data$proponente))[28]] = "Poder Ejecutivo"
data$proponenteR[data$proponente == names(table(data$proponente))[29]] = "Poder Ejecutivo"
data$proponenteR[data$proponente == names(table(data$proponente))[30]] = "Poder Ejecutivo"
data$proponenteR[data$proponente == names(table(data$proponente))[31]] = "Poder Ejecutivo"
data$proponenteR[data$proponente == names(table(data$proponente))[32]] = "RENIEC"
data$proponenteR[data$proponente == names(table(data$proponente))[33]] = "RENIEC"
data$proponenteR[data$proponente == names(table(data$proponente))[34]] = "SBS"
data$proponenteR[data$proponente == names(table(data$proponente))[35]] = "TC"
data$proponenteR[data$proponente == names(table(data$proponente))[36]] = "TC"
```

```{r include=FALSE}
#Poder Ejecutivo
data$ProponeEjecutivo = factor(ifelse(data$proponenteR=="Poder Ejecutivo",1,0))
```

```{r include=FALSE}
#Grupo Parlamentario 
data$grupoParlamentarioR=data$grupoParlamentario

data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[3]] = "Multipartidario"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[9]] = "Multipartidario"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[11]] = "Comision Especial"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[25]] = "Partido Aprista Peruano"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[26]] = "Multipartidario"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[27]] = "Multipartidario"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[29]] = "Multipartidario"
data$grupoParlamentarioR[data$grupoParlamentario == names(table(data$grupoParlamentario))[33]] = "Multipartidario"
```

```{r include=FALSE}
#Partido oficialista
data$GPOficialista=factor(ifelse(data$congresoR=="C1995_2000" & 
                                 data$grupoParlamentarioR == "Grupo Fujimorista",1,
                          ifelse(data$congresoR=="C2001_2006" &  
                                 data$grupoParlamentarioR == "Peru Posible",1,
                          ifelse(data$congresoR=="C2006_2011" &  
                                 data$grupoParlamentarioR == "Partido Aprista Peruano",1,
                          ifelse(data$congresoR=="C2011_2016" &  
                                 data$grupoParlamentarioR == "Grupo Parlamentario Nacionalista",1, 
                          ifelse(data$congresoR=="C2016_2021" &  
                                 data$grupoParlamentarioR == "Peruanos por el Kambio",1,0))))))
```

```{r include=FALSE}
#Estado promulgado
data$Promulgado= factor(ifelse(grepl("Publicado", data$estadoFinal),1,
                       ifelse(grepl("Promulgado", data$estadoFinal),1,0)))
```


```{r include=FALSE}
#Fecha presentaci??n:
data$fechaPresentacion = as.POSIXct(strptime(data$fechaPresentacion, format="%d/%m/%y"))
```

```{r include=FALSE}
#Fecha estado final:
data$FechaPromulgado = ifelse(data$congresoR=="C1995_2000" & 
                                 data$Promulgado == "0","26/07/00",
                          ifelse(data$congresoR =="C2001_2006" &  
                                 data$Promulgado == "0","26/07/06",
                          ifelse(data$congresoR =="C2006_2011" &  
                                 data$Promulgado == "0","26/07/11",
                          ifelse(data$congresoR =="C2011_2016" &  
                                 data$Promulgado == "0","26/07/16", 
                          ifelse(data$congresoR =="C2016_2021" &  
                                 data$Promulgado == "0","12/11/18", data$estadoFinalFecha)))))

data$FechaPromulgado=as.POSIXct(strptime(data$FechaPromulgado, format="%d/%m/%y"))
```

```{r include=FALSE}
#Tiempo publicacion
data$TiempoP=difftime(data$FechaPromulgado,data$fechaPresentacion, units = "weeks")
```

```{r}
data$sumilla=tolower(data$sumilla)

#Impuestos
data$Impuestos = factor(ifelse(grepl("impuesto", data$sumilla),1,0))

#Lima
data$Lima = factor(ifelse(grepl("lima", data$sumilla),1,0))
```


```{r}
table(data$Impuestos)
```

__Índice __

  * [Introducción](#Intro)
  * [Análisis periodo 1995-2000](#P1995)
  * [Análisis periodo 2001-2006](#P2001)
  * [Análisis periodo 2006-2011](#P2006)
  * [Análisis periodo 2011-2016](#P2011) 
  * [Análisis periodo 2016-2021](#P2016)
    
#### Introducción

<a id='Intro'></a> 

El siguiente ejercicio evalúa la promulgación de leyes de los últimos 5 periodos parlamentarios. En total, se analizaron **34 587 propuestas de ley.** El énfasis se encuentra en el análisis de los tiempos necesarios para promulgar una ley.  

El siguiente gráfico muestra el total de leyes analizadas por periodo de gobierno. Como se observa, el periodo 2001-2006 muestra una marcada diferencia en la producción de leyes con respecto a los otros periodos parlamentarios, encontrandose por encima del promedio.

```{r include=FALSE}
leyesCongreso = data %>% group_by(congresoR) %>%  summarise(leyes=n()) 
```

```{r fig.height = 3.5, echo=FALSE,warning=FALSE}
ggplot(data=leyesCongreso, aes(x=congresoR, y=leyes)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Propuestas de ley por legislatura", y="Numero total", x="Legislatura", caption="Promedio de propuestas de ley por legislatura: 6 917") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(plot.title = element_text(hjust = 0.5)) + geom_hline(yintercept = mean(leyesCongreso$leyes) ,linetype="dashed", color="red")  + geom_text(aes(label=leyes), vjust=1.6, color="white", size=3) 
```

###  Análisis periodo 1995-2000

<a id='P1995'></a> 

En la siguiente sección, se analizan las **5 807 leyes propuestas** durante el periodo legislativo 1995-2000. 

#### Proponentes

Una ley puede ser propuesta por distintas instituciones o actores de la sociedad civil. En el periodo legislativo 1995-2000, se encontraron 14 proponentes distintos. A continuación, se muestra el número de leyes propuestas por proponente. De acuerdo a ello, después del Congreso, el Poder Ejecutivo y los Gobiernos Locales registraron el mayor número de leyes propuestas y promulgadas en el periodo de estudio. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C1995_2000") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes[c(1,2)], options=list(pageLength=5, scrollX="500px"))
```

En el periodo legislativo 1995-2000, **el 26% de leyes propuestas fueron promulgadas.** El siguiente gráfico muestra el porcentaje de leyes promulgada en el periodo de estudio, en función del proponente. 

- El Poder Ejecutivo muestra el mayor porcentaje de leyes promulgadas. El 79% de las leyes propuestas por el Ejecutivo fueron promulgadas. 
- El Congreso promulgó la cuarta parte de las leyes que propuso. El 22% de las leyes propuestas por el Congreso fueron promulgadas. 
- Los Gobiernos Locales se encuentran entre los proponentes con menor porcentaje de leyes promulgadas. Solo el 8% de las leyes propuestas por los Gobiernos Locales fueron promulgadas. 

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:14)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (1995-2000)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

En promedio, en el periodo legislativo 1995-2000, **una ley tardó seis meses en ser promulgada** (26 semanas). El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada, en función del tipo de proponente. 

- Las leyes del Ejecutivo se encuentran por debajo del promedio. Una ley propuesta por el Ejecutivo tarda, en promedio, 2 meses en ser promulgada (9 semanas). 
- Las leyes del Congreso se encuentran por encima del promedio. Una ley propuesta por el Congreso tarda, en promedio, 7 meses en ser promulgada (31 semanas). 
- Las Leyes del Gobierno Local se encuentran por encima del promedio. Una ley propuesta por los Gobiernos Locales tarda, en promedio, 9 meses en ser promulgada (38 semanas). 

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>% 
  group_by(proponenteR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```


```{r fig.height = 4, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (1995-2000)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 23.4 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = 26.17168 ,linetype="dashed", color="red")

```

#### Grupos parlamentarios 

En el periodo 1995-2000, hubieron 13 grupos parlamentarios. A continuación, se muestra el número de leyes propuestas por el Congreso según grupo parlamentario. Importa resaltar que **NO se cuenta con información del grupo parlamentario de 5 752 leyes**. De las leyes que cuentan con información, el Grupo Fujimorista registra la mayor cantidad de leyes propuestas. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C1995_2000" & proponenteR=="Congreso") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

En tanto no se cuenta con información para la mayoría de leyes, no se continuará con el análisis de grupos parlamentarios. 

#### Análisis del contenido de Leyes Propuestas

En la siguiente sección, se analiza el contenido de las sumillas de las leyes propuestas en el perido legislativo 1995-2000. Ello con el objetivo de encontrar patrones en los temas que fueron abordados por las leyes propuestas y promulgadas. Los siguientes gráficos muestran las palabras que fueron mencionadas con mayor frecuencia en las sumillas de las leyes analizadas. 

- La palabra **impuesto** fue la más repetida, tanto en leyes promulgadas como no promulgadas. 
- En el grupo de leyes no promulgadas, destaca palabras relacionadas a: derechos, servicios y regiones. 
- En el grupo de leyes promulgadas, destacan palabras relacionadas a: ventas, promoción y empresas. 

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C1995_2000" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
```

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C1995_2000" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
```

```{r fig.height = 4.5, echo=FALSE,warning=FALSE}
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()

m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))

ggarrange(m2,m1, ncol = 2, nrow = 1)
```

#### Determinantes de la promulgación de leyes 

En la siguiente sección, se analizan los determinantes de la promulgación de leyes en el periodo legislativo 1995-2000, mediante el uso de una **regresión de Cox**. La regresión de Cox permite detectar relaciones entre el *riesgo* de que suceda un determinado suceso (en este caso, de que una ley sea promulgada) y distintas variables explicativas. 

- Que una ley sea propuesta por el grupo parlamentario oficialista, incrementa la probabilidad de que la ley sea promulgada en 6.1%.
- Que una ley sea propuesta por el Ejecutivo, incrementa la probabilidad de que la ley sea promulgada en 8.9%.
- Que una ley se refiera a impuestos, incrementa la probabilidad de que la ley sea promulgada en 2.0%. 

```{r include=FALSE}
ModeloCongreso1=data[data$congresoR=='C1995_2000',]
```

```{r include=FALSE}
library(survival)
ModeloCongreso1$PromulgadaSurv=with(ModeloCongreso1,Surv(TiempoP, as.numeric(Promulgado)))
```

```{r, echo=FALSE}
etiquetas=c("Grupo Oficialista", "Propone Ejecutivo", "Impuestos")
modelo1 <- coxph(PromulgadaSurv ~ GPOficialista + ProponeEjecutivo + Impuestos,data=ModeloCongreso1)
stargazer(modelo1, type = "text", 
          apply.coef = exp,
          apply.se   = exp,covariate.labels=etiquetas,note="Nota: se muestran los coeficientes exp.")
```

<a id='P2001'></a> 

###  Análisis periodo 2001-2006



#### Proponentes

La siguiente tabla muestra el número de leyes propuestas por tipo de proponente y el número de leyes promulgadas por tipo de proponente. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2001_2006") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por tipo de proponente. 

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:15)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2001-2006)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por tipo de proponente [Se consideran únicamente a las leyes promulgadas para el análisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% 
  group_by(proponenteR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```


```{r fig.height = 4, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2001-2006)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 45 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Grupos parlamentarios 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2001_2006") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por grupo parlamentario.

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:6)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2001-2006)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por grupo parlamentario [Se consideran únicamente a las leyes promulgadas para el análisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% 
  group_by(grupoParlamentarioR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```

```{r fig.height = 6, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2001-2006)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 46 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Análisis del contenido de Leyes Propuestas

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2001_2006" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
```

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2001_2006" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
```

```{r fig.height = 4.5, echo=FALSE,warning=FALSE}
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()

m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))

ggarrange(m1,m2, ncol = 2, nrow = 1)
```

#### Determinantes de la promulgación de leyes 

Regresión survival (Periodo 2001 - 2006):

```{r}
ModeloCongreso=data[data$congresoR=='C2001_2006',]
```

```{r}
ModeloCongreso = ModeloCongreso[,c(19,21,22,24)]
```

```{r}
library(survival)
ModeloCongreso$survival=with(ModeloCongreso,Surv(TiempoP, as.numeric(Promulgado)))
```

```{r}
modelo1 <- coxph(survival ~ GPOficialista + ProponeEjecutivo,data=ModeloCongreso)
summary(modelo1)

```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ GPOficialista, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2001 - 2006)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ ProponeEjecutivo, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2001 - 2006)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```


<a id='P2006'></a> 

###  Análisis periodo 2006-2011

#### Proponentes

La siguiente tabla muestra el número de leyes propuestas por tipo de proponente y el número de leyes promulgadas por tipo de proponente. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2006_2011") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por tipo de proponente. 

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:16)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2006-2011)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por tipo de proponente [Se consideran únicamente a las leyes promulgadas para el an??lisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% 
  group_by(proponenteR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```


```{r fig.height = 4, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2006-2011)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 55.8 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Grupos parlamentarios 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2006_2011") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por grupo parlamentario.

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:15)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2006-2011)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por grupo parlamentario [Se consideran únicamente a las leyes promulgadas para el an??lisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% 
  group_by(grupoParlamentarioR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```

```{r fig.height = 6, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2006-2011)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 50.4 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### An??lisis del contenido de Leyes Propuestas

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2006_2011" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
```

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2006_2011" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
```

```{r fig.height = 4.5, echo=FALSE,warning=FALSE}
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()

m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))

ggarrange(m1,m2, ncol = 2, nrow = 1)
```

#### Determinantes de la promulgación de leyes 

Regresión survival (Periodo 2006 - 2011):

```{r}
ModeloCongreso=data[data$congresoR=='C2006_2011',]
```

```{r}
ModeloCongreso = ModeloCongreso[,c(19,21,22,24)]
```

```{r}
library(survival)
ModeloCongreso$survival=with(ModeloCongreso,Surv(TiempoP, as.numeric(Promulgado)))
```

```{r}
modelo1 <- coxph(survival ~ GPOficialista + ProponeEjecutivo,data=ModeloCongreso)
summary(modelo1)

```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ GPOficialista, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2006 - 2011)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ ProponeEjecutivo, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2006 - 2011)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```

<a id='P2011'></a> 

###  Análisis periodo 2011-2016

#### Proponentes

La siguiente tabla muestra el número de leyes propuestas por tipo de proponente y el número de leyes promulgadas por tipo de proponente. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2011_2016") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por tipo de proponente. 

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:16)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2011-2016)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por tipo de proponente [Se consideran únicamente a las leyes promulgadas para el análisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% 
  group_by(proponenteR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```


```{r fig.height = 4, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2011-2016)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 67.8 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Grupos parlamentarios 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2011_2016") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por grupo parlamentario.

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:16)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2011-2016)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por grupo parlamentario [Se consideran únicamente a las leyes promulgadas para el análisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% 
  group_by(grupoParlamentarioR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```

```{r fig.height = 6, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2011-2016)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 45 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Análisis del contenido de Leyes Propuestas

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2011_2016" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
```

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2011_2016" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
```

```{r fig.height = 4.5, echo=FALSE,warning=FALSE}
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()

m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))

ggarrange(m1,m2, ncol = 2, nrow = 1)
```

#### Determinantes de la promulgación de leyes 

Regresión survival (Periodo 2011 - 2016):

```{r}
ModeloCongreso=data[data$congresoR=='C2011_2016',]
```

```{r}
ModeloCongreso = ModeloCongreso[,c(19,21,22,24)]
```

```{r}
library(survival)
ModeloCongreso$survival=with(ModeloCongreso,Surv(TiempoP, as.numeric(Promulgado)))
```

```{r}
modelo1 <- coxph(survival ~ GPOficialista + ProponeEjecutivo,data=ModeloCongreso)
summary(modelo1)

```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ GPOficialista, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2011 - 2016)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ ProponeEjecutivo, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2011 - 2016)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```

<a id='P2016'></a> 

###  Análisis periodo 2016-2021

#### Proponentes

La siguiente tabla muestra el número de leyes propuestas por tipo de proponente y el número de leyes promulgadas por tipo de proponente. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2016_2021") %>% group_by(proponenteR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% group_by(proponenteR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por tipo de proponente. 

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:13)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(proponenteR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por proponente (2016-2021)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por tipo de proponente [Se consideran únicamente a las leyes promulgadas para el análisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% 
  group_by(proponenteR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```


```{r fig.height = 4, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=proponenteR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por proponente (2016-2021)", y="Tiempo promedio (semanas)", x="Proponente", caption="Tiempo promedio: 46.1 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Grupos parlamentarios 

```{r echo=FALSE, message=FALSE, warning=FALSE}
proponentes1 = data %>% filter(congresoR=="C2016_2021") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes=n())

proponentes2 = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% group_by(grupoParlamentarioR)  %>% summarise(N_Leyes_Promulgadas=n())

proponentes= left_join(proponentes1, proponentes2)
proponentes$N_Leyes_Promulgadas[is.na(proponentes$N_Leyes_Promulgadas)]=0
proponentes=proponentes[order(-proponentes$N_Leyes),]
proponentes=proponentes[complete.cases(proponentes),]

datatable(proponentes, options=list(pageLength=5, scrollX="500px"))
```

El siguiente gráfico muestra el estado de las leyes propuestas por grupo parlamentario.

```{r include=FALSE}
proponentes = proponentes  %>% 
         mutate(N_Leyes_NoPromulgadas = N_Leyes - N_Leyes_Promulgadas,
                Promulgadas = (N_Leyes_Promulgadas/N_Leyes)*100,
                NoPromulgadas = (N_Leyes_NoPromulgadas/N_Leyes)*100)

proponentes$orden=c(1:10)

proponentes = gather(proponentes, Estado, value=Porcentaje, Promulgadas, NoPromulgadas)

proponentes$Porcentaje[proponentes$Porcentaje==0] = NA
```

```{r fig.height = 4, echo=FALSE, fig.width=8.5, warning=FALSE}
ggplot(proponentes, aes(x = reorder(grupoParlamentarioR,-orden), y = Porcentaje, fill = Estado)) + 
  geom_bar(stat = "identity") + coord_flip() +
  geom_text(aes(label=paste0(round(Porcentaje,1), "%")), position=position_stack(vjust=0.5), vjust = .5, size = 3, col="white") + labs(title="Estado de leyes propuestas por grupo parlamentario (2016-2021)", y="Porcentaje (%)", x="Tipo de proponente") + theme(plot.title = element_text(hjust = 0.5)) +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))
```

El siguiente gráfico muestra el tiempo promedio para que una ley sea promulgada por grupo parlamentario [Se consideran únicamente a las leyes promulgadas para el análisis].

```{r include=FALSE}
#Promedios: 
meanTiempo = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% 
  group_by(grupoParlamentarioR) %>% 
  summarise(Leyes = n(),
            Tiempo = mean(as.numeric(TiempoP)), 
            seTiempo = seMean(as.numeric(TiempoP)))
meanTiempo=meanTiempo[order(-meanTiempo$Leyes),]
```

```{r fig.height = 6, echo=FALSE,warning=FALSE}
ggplot(meanTiempo, aes(x=grupoParlamentarioR, y=Tiempo)) + 
    geom_errorbar(aes(ymin=Tiempo-seTiempo, ymax=Tiempo+seTiempo), width=.1) +
    geom_point()+ labs(title="Tiempo promedio para promulgar una ley por Grupo Parlamentario (2016-2021)", y="Tiempo promedio (semanas)", x="Grupo Parlamentario", caption="Tiempo promedio: 32 semanas") + theme(plot.title = element_text(hjust = 0.5)) + theme(panel.background=element_rect(fill = "white", colour = "black")) + theme(axis.text.x = element_text(angle = 90, hjust = 1))+ geom_hline(yintercept = mean(meanTiempo$Tiempo) ,linetype="dashed", color="red")

```

#### Análisis del contenido de Leyes Propuestas

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2016_2021" & Promulgado=="1") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
d=d[c(1:20),]
d=d[order(-d$freq),]
d$orden=c(1:20)
```

```{r include=FALSE}
dataText = data %>% filter(congresoR=="C2016_2021" & Promulgado=="0") %>% select(sumilla)
modi<-Corpus(VectorSource(dataText$sumilla))
```

```{r include=FALSE}
modi_data<-tm_map(modi,stripWhitespace)
modi_data<-tm_map(modi_data,tolower)
modi_data<-tm_map(modi_data,removeNumbers)
modi_data<-tm_map(modi_data,removePunctuation)
modi_data<-tm_map(modi_data,removeWords, stopwords("spanish"))
```

```{r include=FALSE}
modi_data<-tm_map(modi_data, removeWords, c("ley", "articulo", "decreto", "legislativo", "modificado", "modifica", "proyecto", "general", "modificando", "codigo", "articulos", "estableciendo", "republica", "referente", "inciso", "peru", "comision", "establece", "organica", "fin", "anos", "plazo", "ano", "declarando", "plazo", "diciembre", "presente", "parrafo", "texto", "creando", "derogando", "cada", "dos", "seran", "mas", "cargo", "refiere", "declara", "autoriza", "partir", "referido", "forma", "deroga", "actos", "dia", "supremo", "final", "san", "dicha", "caso", "nacional", "ser", "asi", "mismo", "titulo", "toda", "todo", "prorroga", "publico", "publica", "acuerdo", "poder", "vigencia", "dias", "disposicion", "propone", "modificar", "num", "propuesta", "incorporar", "declarar", "establecer", "autorizar", "crear", "interes", "necesidad"))
```

```{r include=FALSE}
dtm <- TermDocumentMatrix(modi_data)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d2 <- data.frame(word = names(v),freq=v)
d2=d2[c(1:20),]
d2=d2[order(-d2$freq),]
d2$orden=c(1:20)
```

```{r fig.height = 4.5, echo=FALSE,warning=FALSE}
m1= ggplot(d, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip()

m2= ggplot(d2, aes(x = reorder(word,-orden), y = freq)) +
  geom_bar(stat="identity", fill="darkgrey") + labs(title="Leyes No Promulgadas", y="Numero de menciones", x="") +
    	    theme(panel.background=element_rect(fill = "white", colour = "black")) + coord_flip() + scale_y_continuous(breaks = seq(0, 250, by = 50))

ggarrange(m1,m2, ncol = 2, nrow = 1)
```

#### Determinantes de la promulgación de leyes 

Regresión survival (Periodo 2016 - 2021):

```{r}
ModeloCongreso=data[data$congresoR=='C2016_2021',]
```

```{r}
ModeloCongreso = ModeloCongreso[,c(19,21,22,24)]
```

```{r}
library(survival)
ModeloCongreso$survival=with(ModeloCongreso,Surv(TiempoP, as.numeric(Promulgado)))
```

```{r}
modelo1 <- coxph(survival ~ GPOficialista + ProponeEjecutivo,data=ModeloCongreso)
summary(modelo1)
```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ GPOficialista, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2016 - 2021)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)
```

```{r}
library(ggplot2)
library(ggfortify)
KM.fondos = survfit(survival ~ ProponeEjecutivo, data = ModeloCongreso)

###
ejeX='TIEMPO HASTA QUE SE PUBLICA EL PROYECTO\n curva cae cuando el proyecto es publicado'
ejeY='Probabilidad de que el proyecto sea publicado'
titulo="Curva de Sobrevivencia (2016 - 2021)"
autoplot(KM.fondos,
         xlab=ejeX,
         ylab=ejeY, 
         main = titulo,
         conf.int = F)

```
------

<a id='team'></a>

**El equipo del LabPUCP est?? conformado por:**

- Director: Dr. Jos?? Manuel Magallanes

- Investigadora Senior: Lic. Mar??a Gracia Becerra

- Investigador Junior: Alexander Benites
